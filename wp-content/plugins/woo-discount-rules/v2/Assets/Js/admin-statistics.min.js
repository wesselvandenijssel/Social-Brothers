var response_content,isjQueryReady=!1,isGoogleChartsReady=!1,isInitialized=!1;function googleChartsLoadCallback(){isGoogleChartsReady=!0,init()}function init(){isjQueryReady&&isGoogleChartsReady&&!isInitialized&&(isInitialized=!0,jQuery(".chart-period").change(function(){var t=jQuery(".chart-period").val(),e=new Date;if("this_week"===t)e.setDate(e.getDate()-e.getDay()+1),jQuery(".chart-period-start").val(format_date(e)),e.setDate(e.getDate()+6),jQuery(".chart-period-end").val(format_date(e));else if("this_month"===t){var a=new Date(e.getFullYear(),e.getMonth(),1);jQuery(".chart-period-start").val(format_date(a));var r=new Date(e.getFullYear(),e.getMonth()+1,-1);jQuery(".chart-period-end").val(format_date(r))}}),jQuery(".chart-period-start, .chart-period-end").change(function(){jQuery(".chart-period").val("custom")}),jQuery(".chart-options").submit(function(t){return t.preventDefault(),showChart(jQuery(this).serialize()),!1}),jQuery(window).resize(function(){response_content.data.columns.length>1&&renderChart(response_content.data)}),jQuery(".chart-period").change(),jQuery(".chart-options").submit())}function renderChart(t){var e=new google.visualization.DataTable;(t.columns&&t.columns.forEach(function(t,a){e.addColumn(0===a?"string":"number",t)}),t.rows)&&(e.addRows(Object.values(t.rows)),new google.visualization.NumberFormat({fractionDigits:2}).format(e,1));var a=jQuery("#chart-container").width(),r=jQuery(window).height()-jQuery("#chart-container").offset().top;200>r&&(r=200);var o={chart:{title:t.title?t.title:"",subtitle:t.subtitle?t.subtitle:""},width:a,height:r};new google.charts.Line(document.getElementById("chart-container")).draw(e,o)}function showChart(t){let e=jQuery(".woo_discount_loader");e.show(),jQuery.post(ajaxurl,{action:"wdr_admin_statistics",method:"get_chart_data",params:t},function(t){e.hide(),t.success&&t.data.columns.length>1?(response_content=t,renderChart(t.data)):jQuery("#chart-container").html(wdr_data.localization_data.chart_data)},"json")}function to2Digits(t){return t<10?"0"+t:t}function format_date(t){return[to2Digits(t.getFullYear()),to2Digits(t.getMonth()+1),to2Digits(t.getDate())].join("-")}google.charts.load("current",{packages:["line"]}),google.charts.setOnLoadCallback(googleChartsLoadCallback),jQuery(document).ready(function(){isjQueryReady=!0,jQuery(".chart-type").select2(),init()});